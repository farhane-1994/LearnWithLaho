<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF to Excel Converter</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.16.0/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx-populate/3.11.1/xlsx-populate.min.js"></script>
</head>
<body>
    <h1>PDF to Excel Converter</h1>
    <input type="file" id="pdfFile" accept=".pdf">
    <button onclick="convertToExcel()">Convert to Excel</button>

    <script>
        async function convertToExcel() {
            const fileInput = document.getElementById('pdfFile');
            const file = fileInput.files[0];
            
            // قراءة ملف PDF
            const reader = new FileReader();
            reader.readAsArrayBuffer(file);
            reader.onload = async () => {
                const pdfData = reader.result;
                const pdfDoc = await pdfLib.PDFDocument.load(new Uint8Array(pdfData));
                
                // إنشاء ملف Excel
                const wb = await xlsxPopulate.fromBlankAsync();
                const ws = wb.sheet(0);
                
                // استخراج النص من الصفحات في ملف PDF وإدراجه في ملف Excel
                let row = 1;
                pdfDoc.getPages().forEach(page => {
                    const text = page.getText();
                    text.split('\n').forEach((line, index) => {
                        ws.cell(row + index, 1).value(line);
                    });
                    row += text.split('\n').length;
                });

                // تنزيل الملف المحول
                const excelBlob = await wb.outputAsync();
                const downloadLink = document.createElement('a');
                downloadLink.href = window.URL.createObjectURL(new Blob([excelBlob], { type: 'application/octet-stream' }));
                downloadLink.download = 'converted_excel.xlsx';
                downloadLink.click();
            };
        }
    </script>
</body>
</html>
